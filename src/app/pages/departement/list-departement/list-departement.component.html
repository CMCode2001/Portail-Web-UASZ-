<!-- MON ENTETE -->
<div class=" header bg-danger pb-3" id="bg-navbar-main">
  <div class=" container-fluid">
    <div class=" header-body"> 
      <div class=" row align-items-center py-4">
        <div class=" col-lg-6 col-7">
          <h6 class=" h2 text-white d-inline-block mb-0"> Departement de LASHU </h6>

          <nav
            aria-label="breadcrumb"
            class=" d-none d-md-inline-block ml-md-4"
          >
            <!-- <ol class=" breadcrumb breadcrumb-links breadcrumb-dark">
              <li class=" breadcrumb-item">
                <a href="javascript:void(0)"> <i class=" fas fa-home"> </i> </a>
              </li>

              <li aria-current="page" class=" breadcrumb-item active">
                <a href="javascript:void(0)"> liste departement </a>
              </li>
            </ol> -->
          </nav>
        </div>
        <div class=" col-lg-6 col-5 text-right">
          <button class=" btn btn-sl " id ="btnColor2" (click)="open(addDept)"> 
              <i class="ni ni-fat-add"></i> 
              Add New Departement 
          </button>
        </div>
      </div>
    </div>
  </div>
</div>


<!----------------------- FORMULAIRE D'AJOUT ------------------------------>

<ng-template #addDept let-c="close" let-d="dismiss">
  <div class="modal-content">
    <div class="modal-header">
      <h6 class="modal-title " id="modal-title-default" >Ajouter un nouveau Departement à LASHU</h6>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button" (click)="d('Cross click')">
        <span aria-hidden="true" style="color: white;"> × </span>
      </button>
    </div>
    <div class="modal-body">
          <form [formGroup]="myForm" >
            <div class="form-group ">
              <h4 for="example-text-input"> Nom Departement </h4>
                  <input
                    formControlName="libelleDept"
                    class="form-control"
                    placeholder="nom departement"
                    type="text">
            </div>
              
            <div class="form-group" >
              <h4 for="example-search-input" >Description Departement</h4>
              <textarea 
                  class="form-control" 
                  placeholder="Description" 
                  formControlName="descriptionDept" 
                  rows="5">
              </textarea>
            </div>

            <div class="form-group">
              <label for="direction">Assigner une Direction</label>
              <select formControlName="direction" class="form-control">
                <option *ngFor="let direction of Directions" [value]="direction.id">{{ direction.libelleDirection }}</option>
              </select>
            </div>

            <div class="d-flex justify-content-between">
                  <button class="btn" id="btnColor2" type="submit" (click)="ajouterDepartement()"> Enregistrer </button>
                  <button class="btn btn-danger text-center" (click)="d('Cross click')"> Annuler </button>
            </div>
          </form>
  </div>
</div>
</ng-template>

<!-- <br/><br/> -->

<!-- MA LISTE DATATABLE -->
<div class=" container-fluid ">
  <div class=" row">
              <div class="dataTables_wrapper py-4">
                  <div class="row">
                      <div class="col-sm-12 col-md-6">
                          <div class="dataTables_length"
                              id="datatable_length">
                              <label style="color: black;">
                                  Afficher les
                                  <select
                                      name="datatable_length"
                                      aria-controls="datatable"
                                      class="form-control form-control-sm"
                                      (change)="entriesChange($event)">
                                      <option value="5"
                                          [selected]="entries==5">5</option>
                                      <option value="10"
                                          [selected]="entries==10">10</option>
                                      <option value="25"
                                          [selected]="entries==25">25</option>
                                      <option value="50"
                                          [selected]="entries==50">50</option>
                                      <option value="-1"
                                          [selected]="entries==-1">All</option>
                                  </select>
                                  premieres
                              </label>
                          </div>
                      </div>
                      <div >
                          <!-- class="col-sm-12 col-md-6" -->
                          <div id="datatable_filter"
                              class="dataTables_filter">
                              <label>
                                  <input
                                      type="search"
                                      class="form-control form-control-sm"
                                      placeholder="Rechercher un departement"
                                      aria-controls="datatable"
                                      (keyup)="filterTable($event)" />
                              </label>
                          </div>
                      </div>
                  </div>
                  <div class="row">
                      <div >
                          <ngx-datatable 
                              id=" my-datatable"
                              class="bootstrap selection-cell "
                              [headerHeight]="'auto'"
                              [style]="'color:green'"
                              [footerHeight]="'auto'"
                              [rowHeight]="'auto'"
                              [columnMode]="'standard'"
                              (activate)="onActivate"
                              [limit]="entries != -1 ? entries:undefined"
                              [rows]="temp"
                              >

                              <!-- <ngx-datatable-column
                                  name="id"
                                  [width]="100">
                              </ngx-datatable-column> -->

                              <ngx-datatable-column
                                  name="libelleDept"
                                  [width]="400">
                              </ngx-datatable-column>

                              <ngx-datatable-column
                                  name=" descriptionDept"
                                  [width]="450">
                              </ngx-datatable-column>

                              <ngx-datatable-column
                                  name="Opérations"
                                  [width]="150"
                                  [sortable]="false"
                                  [canAutoResize]="false"
                                  [resizeable]="false">
                                  <ng-template let-row="row" ngx-datatable-cell-template>

                                      <i class="fas fa-pencil-alt solid text-success" 
                                      style="cursor: pointer;"
                                      (click)="openEditModal(editDept ,row)"></i> 
                                      &nbsp;                                            
                                      &nbsp;                                            
                                      &nbsp;                                            
                                      <i class="fas fa-trash-alt text-danger" 
                                      style="cursor: pointer;"
                                      (click)="suppressionDepartement(row.id)"></i> 
                                                                                
                                  </ng-template>
                              </ngx-datatable-column>

                              <ngx-datatable-column
                                  name="Details"
                                  [width]="150"
                                  [sortable]="false"
                                  [canAutoResize]="false"
                                  [resizeable]="false">
                                  <ng-template let-row="row" ngx-datatable-cell-template>
                                      <button 
                                      class="btn btn-sm" 
                                      id="btnColor2"  
                                      (click)="openDetailsModal(detailsModal, row.id)">
                                          Détails
                                      </button>
                                  </ng-template>
                              </ngx-datatable-column>

                          </ngx-datatable>
                      </div>
                  </div>
              </div>
          </div>
      </div>

<!-- ===================================================== -->
<ng-template #detailsModal let-c="close" let-d="dismiss">
  <div class="modal-content">
    <div class="modal-header">
      <h6 class="modal-title" style="color: white;">Formations Assignées au Département</h6>
      <button aria-label="Close" class="close" type="button" (click)="d('Cross click')">
        <span aria-hidden="true">×</span>
      </button>
    </div>
    <div class="modal-body">
      <ul *ngIf="Formations.length > 0">
        <li *ngFor="let formation of Formations; let i = index">
          <h6 style="color: black;">Nom Formation {{ i + 1 }} :</h6> 
          <p> <b> {{ formation.libelleForm }} </b> </p> 

          <h6 style="color: black;">Descriptif :<br/>
            <p>{{ formation.descriptionForm }}</p>
          </h6>

          <h6 style="color: black;">Direction :</h6> 
    <p *ngIf="selectedDepartementDirection">
      <b> {{ selectedDepartementDirection.libelleDirection }} </b> 
    </p>
    <p *ngIf="!selectedDepartementDirection">
      Aucune direction n'est assignée à ce département.
    </p>

          
        </li>
      </ul>
      <p *ngIf="Formations.length === 0">Aucune formation assignée à ce département.</p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="c('Close click')">Fermer</button>
    </div>
  </div>
</ng-template>




<!-- ===================================================== -->

  <!-- ---------------- FORMULAIRE D'EDITION  --------------------->
  <ng-template #editDept let-c="close" let-d="dismiss">
    <div class="modal-content">
      <div class="modal-header">
        <h6 class="modal-title " id="modal-title-default" >Modification Partenaire de LASHU</h6>
        <button aria-label="Close" class="close" data-dismiss="modal" type="button" (click)="d('Cross click')">
          <span aria-hidden="true" style="color: white;"> × </span>
        </button>
      </div>
      <div class="modal-body">
            <form [formGroup]="myForm" >
              <div class="form-group ">
                <h4 for="example-text-input"> Nom Departement </h4>
                    <input
                      formControlName="libelleDept"
                      class="form-control"
                      placeholder="nom departement"
                      type="text">
              </div>
                
              <div class="form-group" >
                <h4 for="example-search-input" >Description Departement</h4>
                <textarea 
                    class="form-control" 
                    placeholder="Description" 
                    formControlName="descriptionDept" 
                    rows="5">
                </textarea>
              </div>
        
              <div class="d-flex justify-content-between">
                    <button class="btn" id="btnColor2" type="submit" (click)="modifierDepartement()"> Modifier </button>
                    <button class="btn btn-danger text-center" (click)="c('Close click')" > Annuler </button>
              </div>
            </form>
    </div>
  </div>
  </ng-template>